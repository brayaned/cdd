Listo: te lo dejo renombrado completo para que todo quede bajo el módulo Catálogos:

CatalogosController

CatalogosService

CatalogosRepository (en realidad quedan 3 repos por tabla, pero todos con prefijo Catalogos...)

DTOs con prefijo Catalogos...


Mantengo exactamente el mismo CRUD (GET/POST upsert/DELETE), campos de creación/modificación y auditoría.


---

1) DTOs

CatalogosPaisProbabilidadUpsertRequest.java

package com.santander.bnc.bsn023.bncbsn023siarbackendj.app.dto;

import java.math.BigDecimal;
import java.time.LocalDate;

public class CatalogosPaisProbabilidadUpsertRequest {

    private String tipo;          // TIPO_PAIS
    private String id;            // CODIGO_PAIS
    private BigDecimal riesgo;    // PROBABILIDAD_RIESGO
    private LocalDate fechaVigencia;

    public String getTipo() { return tipo; }
    public void setTipo(String tipo) { this.tipo = tipo; }

    public String getId() { return id; }
    public void setId(String id) { this.id = id; }

    public BigDecimal getRiesgo() { return riesgo; }
    public void setRiesgo(BigDecimal riesgo) { this.riesgo = riesgo; }

    public LocalDate getFechaVigencia() { return fechaVigencia; }
    public void setFechaVigencia(LocalDate fechaVigencia) { this.fechaVigencia = fechaVigencia; }
}

CatalogosItemResponse.java

package com.santander.bnc.bsn023.bncbsn023siarbackendj.app.dto;

import java.math.BigDecimal;
import java.time.LocalDate;

public class CatalogosItemResponse {

    private String id;
    private String nombre;
    private String descripcion;
    private BigDecimal riesgo;
    private LocalDate fechaVigencia;
    private String tipo;

    public String getId() { return id; }
    public void setId(String id) { this.id = id; }

    public String getNombre() { return nombre; }
    public void setNombre(String nombre) { this.nombre = nombre; }

    public String getDescripcion() { return descripcion; }
    public void setDescripcion(String descripcion) { this.descripcion = descripcion; }

    public BigDecimal getRiesgo() { return riesgo; }
    public void setRiesgo(BigDecimal riesgo) { this.riesgo = riesgo; }

    public LocalDate getFechaVigencia() { return fechaVigencia; }
    public void setFechaVigencia(LocalDate fechaVigencia) { this.fechaVigencia = fechaVigencia; }

    public String getTipo() { return tipo; }
    public void setTipo(String tipo) { this.tipo = tipo; }
}


---

2) Repositories (prefijo Catálogos)

CatalogosPaisProbabilidadRepository.java

package com.santander.bnc.bsn023.bncbsn023siarbackendj.app.repository;

import com.santander.bnc.bsn023.bncbsn023siarbackendj.app.entity.PerfilRiesgoPaisProbabilidadEntity;
import com.santander.bnc.bsn023.bncbsn023siarbackendj.app.entity.PerfilRiesgoPaisProbabilidadId;
import org.springframework.data.jpa.repository.JpaRepository;

import java.util.List;

public interface CatalogosPaisProbabilidadRepository
        extends JpaRepository<PerfilRiesgoPaisProbabilidadEntity, PerfilRiesgoPaisProbabilidadId> {

    List<PerfilRiesgoPaisProbabilidadEntity> findByTipoPais(String tipoPais);
}

CatalogosPaisRepository.java

package com.santander.bnc.bsn023.bncbsn023siarbackendj.app.repository;

import com.santander.bnc.bsn023.bncbsn023siarbackendj.app.entity.PerfilRiesgoPaisEntity;
import org.springframework.data.jpa.repository.JpaRepository;

public interface CatalogosPaisRepository extends JpaRepository<PerfilRiesgoPaisEntity, String> {
}

CatalogosPaisProbabilidadAuditoriaRepository.java

package com.santander.bnc.bsn023.bncbsn023siarbackendj.app.repository;

import com.santander.bnc.bsn023.bncbsn023siarbackendj.app.entity.PerfilRiesgoPaisProbabilidadAuditoriaEntity;
import org.springframework.data.jpa.repository.JpaRepository;

public interface CatalogosPaisProbabilidadAuditoriaRepository
        extends JpaRepository<PerfilRiesgoPaisProbabilidadAuditoriaEntity, Long> {
}


---

3) Service

CatalogosService.java

package com.santander.bnc.bsn023.bncbsn023siarbackendj.app.service;

import com.santander.bnc.bsn023.bncbsn023siarbackendj.app.dto.CatalogosItemResponse;
import com.santander.bnc.bsn023.bncbsn023siarbackendj.app.dto.CatalogosPaisProbabilidadUpsertRequest;
import com.santander.bnc.bsn023.bncbsn023siarbackendj.app.entity.*;
import com.santander.bnc.bsn023.bncbsn023siarbackendj.app.repository.*;
import org.springframework.security.core.Authentication;
import org.springframework.security.core.context.SecurityContextHolder;
import org.springframework.stereotype.Service;
import org.springframework.transaction.annotation.Transactional;

import java.time.LocalDateTime;
import java.util.List;

@Service
public class CatalogosService {

    private final CatalogosPaisProbabilidadRepository probRepo;
    private final CatalogosPaisRepository paisRepo;
    private final CatalogosPaisProbabilidadAuditoriaRepository auditRepo;

    public CatalogosService(
            CatalogosPaisProbabilidadRepository probRepo,
            CatalogosPaisRepository paisRepo,
            CatalogosPaisProbabilidadAuditoriaRepository auditRepo
    ) {
        this.probRepo = probRepo;
        this.paisRepo = paisRepo;
        this.auditRepo = auditRepo;
    }

    public List<CatalogosItemResponse> listarPaisProbabilidad(String tipoPais) {
        var rows = (tipoPais == null || tipoPais.isBlank())
                ? probRepo.findAll()
                : probRepo.findByTipoPais(tipoPais);

        return rows.stream().map(this::toResponse).toList();
    }

    @Transactional
    public CatalogosItemResponse upsertPaisProbabilidad(CatalogosPaisProbabilidadUpsertRequest req) {
        validar(req);

        var now = LocalDateTime.now();
        var user = currentUser();

        var id = new PerfilRiesgoPaisProbabilidadId();
        id.tipoPais = req.getTipo();
        id.codigoPais = req.getId();

        var existingOpt = probRepo.findById(id);

        PerfilRiesgoPaisProbabilidadEntity entity;
        if (existingOpt.isPresent()) {
            entity = existingOpt.get();

            entity.setProbabilidadRiesgo(req.getRiesgo());
            entity.setFechaVigencia(req.getFechaVigencia());
            entity.setFechaUltimaModificacion(now);
            entity.setUsuarioUltimaModificacion(user);

            auditRepo.save(snapshotAudit(entity));

        } else {
            entity = new PerfilRiesgoPaisProbabilidadEntity();
            entity.setTipoPais(req.getTipo());
            entity.setCodigoPais(req.getId());
            entity.setProbabilidadRiesgo(req.getRiesgo());
            entity.setFechaVigencia(req.getFechaVigencia());

            entity.setFechaCreacion(now);
            entity.setUsuarioCreacion(user);
            entity.setFechaUltimaModificacion(null);
            entity.setUsuarioUltimaModificacion(null);

            probRepo.save(entity);
            auditRepo.save(snapshotAudit(entity));
        }

        return toResponse(entity);
    }

    @Transactional
    public void eliminarPaisProbabilidad(String tipoPais, String codigoPais) {
        var id = new PerfilRiesgoPaisProbabilidadId();
        id.tipoPais = tipoPais;
        id.codigoPais = codigoPais;

        var entity = probRepo.findById(id)
                .orElseThrow(() -> new IllegalArgumentException(
                        "No existe registro para tipo=" + tipoPais + " id=" + codigoPais
                ));

        var now = LocalDateTime.now();
        var user = currentUser();
        entity.setFechaUltimaModificacion(now);
        entity.setUsuarioUltimaModificacion(user);

        auditRepo.save(snapshotAudit(entity));
        probRepo.delete(entity);
    }

    // ----------------- helpers -----------------

    private void validar(CatalogosPaisProbabilidadUpsertRequest req) {
        if (req.getTipo() == null || req.getTipo().isBlank())
            throw new IllegalArgumentException("tipo (TIPO_PAIS) es requerido");
        if (req.getId() == null || req.getId().isBlank())
            throw new IllegalArgumentException("id (CODIGO_PAIS) es requerido");
        if (req.getRiesgo() == null)
            throw new IllegalArgumentException("riesgo (PROBABILIDAD_RIESGO) es requerido");
        if (req.getFechaVigencia() == null)
            throw new IllegalArgumentException("fechaVigencia (FECHA_VIGENCIA) es requerido");
    }

    private CatalogosItemResponse toResponse(PerfilRiesgoPaisProbabilidadEntity e) {
        var resp = new CatalogosItemResponse();
        resp.setTipo(e.getTipoPais());
        resp.setId(e.getCodigoPais());
        resp.setNombre(e.getCodigoPais());

        var paisDesc = paisRepo.findById(e.getCodigoPais())
                .map(PerfilRiesgoPaisEntity::getDescripcionPais)
                .orElse(null);

        resp.setDescripcion(paisDesc);
        resp.setRiesgo(e.getProbabilidadRiesgo());
        resp.setFechaVigencia(e.getFechaVigencia());
        return resp;
    }

    private PerfilRiesgoPaisProbabilidadAuditoriaEntity snapshotAudit(PerfilRiesgoPaisProbabilidadEntity e) {
        var a = new PerfilRiesgoPaisProbabilidadAuditoriaEntity();

        // si tu auditoría tiene @GeneratedValue con sequence, NO seteas id aquí
        a.setTipoPais(e.getTipoPais());
        a.setCodigoPais(e.getCodigoPais());
        a.setProbabilidadRiesgo(e.getProbabilidadRiesgo());
        a.setFechaVigencia(e.getFechaVigencia());

        a.setFechaCreacion(e.getFechaCreacion());
        a.setUsuarioCreacion(e.getUsuarioCreacion());
        a.setFechaUltimaModificacion(e.getFechaUltimaModificacion());
        a.setUsuarioUltimaModificacion(e.getUsuarioUltimaModificacion());

        return a;
    }

    private String currentUser() {
        Authentication auth = SecurityContextHolder.getContext().getAuthentication();
        if (auth == null || auth.getName() == null) return "SYSTEM";
        return auth.getName();
    }
}


---

4) Controller

CatalogosController.java

package com.santander.bnc.bsn023.bncbsn023siarbackendj.app.controller;

import com.santander.bnc.bsn023.bncbsn023siarbackendj.app.dto.CatalogosItemResponse;
import com.santander.bnc.bsn023.bncbsn023siarbackendj.app.dto.CatalogosPaisProbabilidadUpsertRequest;
import com.santander.bnc.bsn023.bncbsn023siarbackendj.app.service.CatalogosService;
import org.springframework.http.ResponseEntity;
import org.springframework.web.bind.annotation.*;

import java.util.List;

@RestController
@RequestMapping("/catalogos")
public class CatalogosController {

    private final CatalogosService service;

    public CatalogosController(CatalogosService service) {
        this.service = service;
    }

    // GET /catalogos/pais-probabilidad?tipo=UBO (opcional)
    @GetMapping("/pais-probabilidad")
    public ResponseEntity<List<CatalogosItemResponse>> listarPaisProbabilidad(
            @RequestParam(name = "tipo", required = false) String tipo
    ) {
        return ResponseEntity.ok(service.listarPaisProbabilidad(tipo));
    }

    // POST /catalogos/pais-probabilidad  (UPSERT: create/update)
    @PostMapping("/pais-probabilidad")
    public ResponseEntity<CatalogosItemResponse> upsertPaisProbabilidad(
            @RequestBody CatalogosPaisProbabilidadUpsertRequest req
    ) {
        return ResponseEntity.ok(service.upsertPaisProbabilidad(req));
    }

    // DELETE /catalogos/pais-probabilidad/{tipo}/{id}
    @DeleteMapping("/pais-probabilidad/{tipo}/{id}")
    public ResponseEntity<Void> eliminarPaisProbabilidad(
            @PathVariable("tipo") String tipo,
            @PathVariable("id") String id
    ) {
        service.eliminarPaisProbabilidad(tipo, id);
        return ResponseEntity.noContent().build();
    }
}


---

Nota rápida (auditoría ID secuencial)

Si tu entity auditoría no tiene aún el @GeneratedValue + @SequenceGenerator, agréguelo como te lo mostré antes (ajustando el nombre real del sequence).


---

Si quieres, en el mismo CatalogosController te puedo dejar también el GET /catalogos que arme el JSON completo por secciones (Industria, Ocupación, Productos, País, etc.) exactamente como tu estructura propuesta.
